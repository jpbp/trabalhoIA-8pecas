<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Parse Tree</title>
    <meta
      name="description"
      content="A collapsible tree layout with all of the leaf nodes at the same layer."
    />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Copyright 1998-2020 by Northwoods Software Corporation. -->

    <script src="go.js"></script>
    <script id="code">
      function init() {
        if (window.goSamples) goSamples(); // init for these samples -- you don't need to call this
        var $ = go.GraphObject.make; // for conciseness in defining templates
        myDiagram = $(go.Diagram, "myDiagramDiv", {
          allowCopy: false,
          allowDelete: false,
          allowMove: false,
          initialAutoScale: go.Diagram.Uniform,
          layout: $(
            FlatTreeLayout, // custom Layout, defined below
            {
              angle: 90,
              compaction: go.TreeLayout.CompactionNone,
            }
          ),
          "undoManager.isEnabled": true,
        });

        myDiagram.nodeTemplate = $(
          go.Node,
          "Vertical",
          { selectionObjectName: "BODY" },
          $(
            go.Panel,
            "Auto",
            { name: "BODY" },
            $(
              go.Shape,
              "RoundedRectangle",
              new go.Binding("fill"),
              new go.Binding("stroke")
            ),
            $(
              go.TextBlock,
              {
                font: "bold 12pt Arial, sans-serif",
                margin: new go.Margin(4, 2, 2, 2),
              },
              new go.Binding("text")
            )
          ),
          $(
            go.Panel, // this is underneath the "BODY"
            { height: 17 }, // always this height, even if the TreeExpanderButton is not visible
            $("TreeExpanderButton")
          )
        );

        myDiagram.linkTemplate = $(go.Link, $(go.Shape, { strokeWidth: 1.5 }));

        // set up the nodeDataArray, describing each part of the sentence
        var nodeDataArray = [
          { key: 1, text: "1", fill: "#f68c06", stroke: "#4d90fe" },
          { key: 2, text: "2", fill: "#f68c06", stroke: "#4d90fe", parent: 1 },
          { key: 3, text: "3", fill: "#f68c06", stroke: "#4d90fe", parent: 1 },
          { key: 4, text: "4", fill: "#f68c06", stroke: "#4d90fe", parent: 1 },
          { key: 5, text: "5", fill: "#f68c06", stroke: "#4d90fe", parent: 2 },
          { key: 6, text: "6", fill: "#f68c06", stroke: "#4d90fe", parent: 3 },
          { key: 7, text: "7", fill: "#f68c06", stroke: "#4d90fe", parent: 3 },
          { key: 8, text: "8", fill: "#f68c06", stroke: "#4d90fe", parent: 3 },
        ];

        myDiagram.addDiagramListener("ObjectSingleClicked", function (e) {
          var part = e.subject.part;
          console.log(part.data.key);
        });
        // create the Model with data for the tree, and assign to the Diagram
        myDiagram.model = $(go.TreeModel, { nodeDataArray: nodeDataArray });
      }

      // Customize the TreeLayout to position all of the leaf nodes at the same vertical Y position.
      function FlatTreeLayout() {
        go.TreeLayout.call(this); // call base constructor
      }
      go.Diagram.inherit(FlatTreeLayout, go.TreeLayout);

      // This assumes the TreeLayout.angle is 90 -- growing downward
      FlatTreeLayout.prototype.commitLayout = function () {
        go.TreeLayout.prototype.commitLayout.call(this); // call base method first
        // find maximum Y position of all Nodes
        var y = -Infinity;
        this.network.vertexes.each(function (v) {
          y = Math.max(y, v.node.position.y);
        });
        // move down all leaf nodes to that Y position, but keeping their X position
        this.network.vertexes.each(function (v) {
          if (v.destinationEdges.count === 0) {
            // shift the node down to Y
            v.node.position = new go.Point(v.node.position.x, y);
            // extend the last segment vertically
            v.node.toEndSegmentLength = Math.abs(v.centerY - y);
          } else {
            // restore to normal value
            v.node.toEndSegmentLength = 10;
          }
        });
      };

      // end FlatTreeLayout
    </script>
  </head>
  <body onload="init()">
    <div id="sample">
      <div
        id="myDiagramDiv"
        style="border: solid 1px black; width: 100%; height: 500px;"
      ></div>
    </div>
  </body>
</html>

<script>
  function criarEstadoInicial(){
    let estado = {
      node: 1,
      parent: "",
      vetor:["2","3","5","6","7","1","8","4","*"]  
    }  
    return estado
  }
  function print(no){
      let printnode=""
      for (let i = 0; i < no.vetor.length; i++){
        if(i==3 || i==6 || i==9){
          printnode+='\n'
        }
        printnode+=no.vetor[i]+" "
      }
      console.log(printnode)
  }
  function alteraPosicao(no,newNode,posicaoEmBranco,posicaoMudanca){
      newNode.vetor[posicaoEmBranco]=no.vetor[posicaoMudanca]
      newNode.vetor[posicaoMudanca]=no.vetor[posicaoEmBranco]
  }
  function criarfila(estadoInicial){
    let nodes = [];
    nodes.push(estadoInicial)
    return nodes;
  }
  function criarNovoEstado(no,posicaoEmBranco,posicaoMudanca){
    let newNo = JSON.parse(JSON.stringify(no))
    alteraPosicao(no,newNo,posicaoEmBranco,posicaoMudanca)
    return newNo
  }
  
  function estadoObjetivo(no){
     if(no.vetor[0]==="1" && no.vetor[1]==="2" && no.vetor[2]==="3" && no.vetor[3]==="8" && no.vetor[4]==="*" && no.vetor[5]==="4" && no.vetor[6]==="7" && no.vetor[7]==="6" && no.vetor[8]==="5"){
       return true
     }else{
       return false
     }
  }

  
  function expandir(nodes,no,repitido){
    let posicao=0;
    for (i = 0; i < no.vetor.length; i++){
        if(no.vetor[i]==="*"){
          posicao=i
        }
    } 
    if(posicao==8){
      nodes.push(criarNovoEstado(no,posicao,5))
      nodes.push(criarNovoEstado(no,posicao,7))
    }
    else if(posicao==5){
      nodes.push(criarNovoEstado(no,posicao,2))
      nodes.push(criarNovoEstado(no,posicao,4))
      nodes.push(criarNovoEstado(no,posicao,8))
    }
    
    console.log("aqui",nodes.length)

    return nodes
  }
  function buscaAmplitude(){
    let estadoInicial=criarEstadoInicial()
    let nodes=criarfila(estadoInicial)
    let no;
    while(nodes.length > 0){
      no=nodes.shift();
      if(estadoObjetivo(no)){
        return no 
      }
      expandir(nodes,no)
      
    }
    
    
  }


 buscaAmplitude()
 
</script>
